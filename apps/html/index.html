<html>
<head>

    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" type="text/css" href="../../node_modules/cesium/Build/Cesium/Widgets/widgets.css">
      

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">

</head>
<body>

<section>

    <div id="search-container">
        <input id="search-id"/>
        <div id="search-results"></div>
    </div>

    <div id="main">
        <div id="attribution"></div>
        <div id="map"></div>
    </div>

</section>



<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script src="https://code.jquery.com/jquery-2.2.1.min.js"></script>
  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
<script src="../../node_modules/cesium/Build/CesiumUnminified/Cesium.js"></script>
<script src="config.js"></script>


<script>
var csConfig = {
    timeline: false, 
    baseLayerPicker: false, 
    geocoder : false, 
    animation: false,
    orderIndependentTranslucency: false,
    skyBox: new Cesium.SkyBox({
      sources : {
        positiveX : 'skybox_px.png',
        negativeX : 'skybox_nx.png',
        positiveY : 'skybox_py.png',
        negativeY : 'skybox_ny.png',
        positiveZ : 'skybox_pz.png',
        negativeZ : 'skybox_nz.png'
      }, show: false
    }),
    fullscreenButton: false,
    babseLayerPicker: false,
    infoBox: false,
    homeButton:false,
    sceneModePicker:false,
    navigationHelpButton: false,
    creditContainer: 'attribution'
}

// var k = _.template()

function search(value, success, error) {
    $.ajax({
        url : 'http://' + config.server + ':9200/toptour/_search?q=' + value,
        success: success,
        error: error
    });
}

$searchResults = $('#search-results');

function handleResponse(data) {

            $searchResults.empty();
            _.each(data.hits.hits, 
                function(hit) {
                    var $hit = $("<p>" + hit._source.navn + '</p>').on('click', function(e) {
                        
                            // addGeoJson(hit._source.geojson);
                        });
                    $searchResults.append($hit);
                    // addGeoJson(hit._source.geojson);
                });
}

$('#search-id').on('keyup', function(e) {

    search(e.currentTarget.value,
        function(data) {    
            handleResponse(data);
        },
        function(error) {
            console.log(error);
        });
});

// $.ajax({
//     method: 'GET', 
//     url : 'http://dev.nasjonalturbase.no/turer?api_key=0e1718433eece23d17c3f49c55018c5bd2181c99',
//     success: function(data) {
//         console.log(data);
//     },
//     error: function(data) {
//         console.log(data);
//     }
// })

</script>
<!-- <script src="app.js"></script> -->

</body>
</html>